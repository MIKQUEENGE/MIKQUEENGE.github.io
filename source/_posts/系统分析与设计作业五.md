---
title: 系统分析与设计作业五
date: 2018-04-15 22:52:13
categories: 
- 系统分析与设计
tags:
- mongoDB
- Flask
toc: true
---

# 配置mongoDB

参考教程：https://www.yiibai.com/mongodb/mongodb_environment.html

下载需要科学上网。

<!-- more -->

另外：

将F:\mongodb\bin\添加到环境变量中。

每次开启前用这个命令修改db缓存路径：

> mongod -dbpath f:\mongodb\data

然后再打开另一个cmd窗口输入mongod即可。

# 了解Python+Flask后端服务实现（win10）

参考资料：http://www.jb51.net/article/60738.htm

## 环境配置

安装pymongo、flask、Pillow：

> easy_install pymongo
>
> easy_install flask
>
> easy_install Pillow

## IDE

使用[PyCharm](https://www.jetbrains.com/pycharm/)

打开PyCharm->新建项目->选择Flask框架->修改路径->创建

得到了一个最简单的hello world的项目：

![first pro](/images/Untitled.png)

## Flask 快速入门

[参考链接](http://www.pythondoc.com/flask/quickstart.html#debug-mode)

运行刚刚创建的hello world程序：

![run](/images/Capture.PNG)

在浏览器输入网址http://127.0.0.1:5000/：

![web](/images/Capture1.PNG)

### 调试模式

在代码修改的时候服务器能够自动加载，
并且如果发生错误，它会提供一个有用的调试器。

使用

```python
app.debug = True
app.run()
```

或者

```python
app.run(debug=True)
```

开启调试模式。

### 路由

[`route()`](http://www.pythondoc.com/flask/api.html#flask.Flask.route) 装饰器用于把一个函数绑定到一个 URL 上。

#### 静态绑定

```python
@app.route('/')
def index():
    return 'Index Page'

@app.route('/hello')
def hello():
    return 'Hello World'
```

#### 动态绑定

把一些特定的字段标记成 `<variable_name>`来进行动态绑定，还可以用 `<converter:variable_name>`限制格式：

```python
@app.route('/user/<username>')
def show_user_profile(username):
    # show the user profile for that user
    return 'User %s' % username

@app.route('/post/<int:post_id>')
def show_post(post_id):
    # show the post with the given id, the id is an integer
    return 'Post %d' % post_id
```

有如下三种转换器：

| int       | 接受整数                        |
| --------- | ------------------------------- |
| **float** | **同 int 一样，但是接受浮点数** |
| **path**  | **和默认的相似，但也接受斜线**  |

### HTTP方法

默认情况下，路由只会响应 GET 请求，但是能够通过给 [`route()`](http://www.pythondoc.com/flask/api.html#flask.Flask.route) 装饰器提供 methods 参数来改变：

```python
@app.route('/login', methods=['GET', 'POST'])
def login():
    if request.method == 'POST':
        do_the_login()
    else:
        show_the_login_form()
```

#### 常见HTTP方法

- GET

  浏览器通知服务器只 *获取* 页面上的信息并且发送回来。这可能是最常用的方法。

- HEAD

  浏览器告诉服务器获取信息，但是只对 *头信息* 感兴趣，不需要整个页面的内容。应用应该处理起来像接收到一个 GET 请求但是不传递实际内容。在 Flask 中你完全不需要处理它，底层的 Werkzeug 库会为你处理的。

- POST

  浏览器通知服务器它要在 URL 上 *提交* 一些信息，服务器必须保证数据被存储且只存储一次。这是 HTML 表单通常发送数据到服务器的方法。

- PUT

  同 POST 类似，但是服务器可能触发了多次存储过程，多次覆盖掉旧值。现在你就会问这有什么用，有许多理由需要如此去做。考虑下在传输过程中连接丢失：在这种情况下浏览器 和服务器之间的系统可能安全地第二次接收请求，而不破坏其它东西。对于 POST 是不可能实现的，因为它只会被触发一次。

- DELETE

  移除给定位置的信息。

- OPTIONS

  给客户端提供一个快速的途径来指出这个 URL 支持哪些 HTTP 方法。从 Flask 0.6 开始，自动实现了它。

### 构建url

可以使用函数[`url_for()`](http://www.pythondoc.com/flask/api.html#flask.url_for) 来针对一个特定的函数构建一个 URL。

它能够接受函数名作为第一参数，以及一些关键字参数，
每一个关键字参数对应于 URL 规则的变量部分。未知变量部分被插入到 URL 中作为查询参数：

```python
>>> from flask import Flask, url_for
>>> app = Flask(__name__)
>>> @app.route('/')
... def index(): pass
...
>>> @app.route('/login')
... def login(): pass
...
>>> @app.route('/user/<username>')
... def profile(username): pass
...
>>> with app.test_request_context():
...  print url_for('index')
...  print url_for('login')
...  print url_for('login', next='/')
...  print url_for('profile', username='John Doe')
...
/
/login
/login?next=/
/user/John%20Doe
```

### 渲染静态文件

只要在你的包中或模块旁边创建一个名为 static 的文件夹，在应用中使用 /static 即可访问。

给静态文件生成 URL：

```python
url_for('static', filename='style.css')
```

这个文件应该存储在 `static/style.css`，而使用PyCharm创建Flask项目时已经为你创建好了static目录：

![目录](/images/Capture2.PNG)

### 渲染模板

由于必须自行做好 HTML 转义以保持应用程序的安全，Flask 自动配置好了 [Jinja2](http://jinja.pocoo.org/2/) 模版。

可以使用方法 [`render_template()`](http://www.pythondoc.com/flask/api.html#flask.render_template) 来渲染模版：

```python
from flask import render_template

@app.route('/hello/')
@app.route('/hello/<name>')
def hello(name=None):
    return render_template('hello.html', name=name)
```

Flask 将会在 templates 文件夹中寻找模版。

# [后续链接]()

